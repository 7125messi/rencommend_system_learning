![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565420410015-361191ff-4492-45d7-a620-64a1360e7f35.png#align=left&display=inline&height=413&name=image.png&originHeight=826&originWidth=1512&size=279736&status=done&width=756)

在推荐系统的早期研究中，很多人将好的推荐系统定义为能够作出准确预测的推荐系统。比如，一个图书推荐系统预测一个用户将来会购买《C++ Primer中文版》这本书，而用户后来确实 购买了，那么这就被看做一次准确的预测。预测准确度是推荐系统领域的重要指标(没有之一)。 这个指标的好处是，它可以比较容易地通过离线方式计算出来，从而方便研究人员快速评价和选 择不同的推荐算法。但是，很多研究表明，准确的预测并不代表好的推荐。1比如说，该用户早 就准备买《C++ Primer中文版》了，无论是否给他推荐，他都准备购买，那么这个推荐结果显然 是不好的，因为它并未使用户购买更多的书，而仅仅是方便用户购买一本他本来就准备买的书。 那么，对于用户来说，他会觉得这个推荐结果很不新颖，不能令他惊喜。同时，对于《C++ Primer 中文版》的出版社来说，这个推荐也没能增加这本书的潜在购买人数。**所以，这是一个看上去很好，但其实却很失败的推荐。举一个更极端的例子，某推测系统预测明天太阳将从东方升起，虽然预测准确率是100%，却是一种没有意义的预测。**

所以，**好的推荐系统不仅仅能够准确预测用户的行为，而且能够扩展用户的视野，帮助用户发现那些他们可能会感兴趣，但却不那么容易发现的东西。同时，推荐系统还要能够帮助商家将那些被埋没在长尾中的好商品介绍给可能会对它们感兴趣的用户。**这也正是《长尾理论》的作者
在书中不遗余力介绍推荐系统的原因。

<a name="qzb5g"></a>
# 1 推荐系统实验方法

在推荐系统中，主要有3种评测推荐效果的实验方法，即**离线实验(offline experiment)、用户调查(user study)
和在线实验(online experiment)。**

<a name="RrQ1j"></a>
## 1.1 离线实验

![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565420761426-8e87fec0-8dd2-4547-97ba-811875e13f11.png#align=left&display=inline&height=210&name=image.png&originHeight=420&originWidth=1510&size=236375&status=done&width=755)![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565420790956-b74400e4-c379-4f8f-bbc4-ee65b89b39e5.png#align=left&display=inline&height=217&name=image.png&originHeight=434&originWidth=1514&size=140472&status=done&width=757)

<a name="gUzxu"></a>
## 1.2 用户调查

![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565420982620-f4acebae-7738-4e65-9ef5-f64376926f99.png#align=left&display=inline&height=646&name=image.png&originHeight=1292&originWidth=1508&size=756197&status=done&width=754)

<a name="Q9i4i"></a>
## 1.3 在线实验

在完成离线实验和必要的用户调查后，可以将推荐系统上线做AB测试，将它和旧的算法进行比较。AB测试是一种很常用的在线评测算法的实验方法。它通过一定的规则将用户随机分成几组， 并对不同组的用户采用不同的算法，然后通过统计不同组用户的各种不同的评测指标比较不同算 法，比如可以统计不同组用户的点击率，通过点击率比较不同算法的性能。

AB测试的优点是可以公平获得不同算法实际在线时的性能指标，包括商业上关注的指标。 AB测试的缺点主要是周期比较长，必须进行长期的实验才能得到可靠的结果。因此一般不会用 AB测试测试所有的算法，而只是用它测试那些在离线实验和用户调查中表现很好的算法。其次， 一个大型网站的AB测试系统的设计也是一项复杂的工程。一个大型网站的架构分前端和后端， 从前端展示给用户的界面到最后端的算法，中间往往经过了很多层，这些层往往由不同的团队控 制，而且都有可能做AB测试。如果为不同的层分别设计AB测试系统，那么不同的AB测试之间往 往会互相干扰。比如，当我们进行一个后台推荐算法的AB测试，同时网页团队在做推荐页面的 界面AB测试，最终的结果就是你不知道测试结果是自己算法的改变，还是推荐界面的改变造成的。因此，切分流量是AB测试中的关键，不同的层以及控制这些层的团队需要从一个统一的地方获得自己AB测试的流量，而不同层之间的流量应该是正交的。

![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565422332118-2dc2bd69-7e78-485c-8e01-e0032f53e9ce.png#align=left&display=inline&height=419&name=image.png&originHeight=838&originWidth=1508&size=280524&status=done&width=754)

一般来说，一个新的推荐算法最终上线，需要完成上面所说的3个实验。

- 首先，需要通过离线实验证明它在很多离线指标上优于现有的算法。
- 然后，需要通过用户调查确定它的用户满意度不低于现有的算法。
- 最后，通过在线的AB测试确定它在我们关心的指标上优于现有的算法。

<a name="rQxH4"></a>
#  2 评价指标

各种推荐系统的评测指标。这些评测指标可用于评价推荐系统各方面的性能。这些指标**有些可以定量计算，有些只能定性描述，有些可以通过离线实验计算，有些需要通过用户调查获得，还有些只能在线评测。**<br />**
<a name="TYRsb"></a>
## 2.1 用户满意度（**用户调查或者在线实验**）

用户作为推荐系统的重要参与者，其满意度是评测推荐系统的最重要指标。但是，**用户满意度没有办法离线计算，只能通过用户调查或者在线实验获得。**

在线系统中，用户满意度主要通过一些对用户行为的统计得到。比如在电子商务网站中，**用户如果购买了推荐的商品，就表示他们在一定程度上满意。因此，我们可以利用购买率度量用户的满意度。此外，有些网站会通过设计一些用户反馈界面收集用户满意度。**

<a name="BGfEa"></a>
## 2.2 预测准确度（**离线评测**）

预测准确度**度量一个推荐系统或者推荐算法预测用户行为的能力**。这个指标是**最重要的推荐系统离线评测指标。**<br />在计算该指标时需要有一个离线的数据集，该数据集包含用户的历史行为记录。然后，将该数据集通过时间分成训练集和测试集。最后，通过在训练集上建立用户的行为和兴趣模型预测用户在测试集上的行为，并计算预测行为和测试集上实际行为的重合度作为预测准确度。

![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565423280167-e9267104-7084-4ec0-a525-a7715a869766.png#align=left&display=inline&height=409&name=image.png&originHeight=818&originWidth=1944&size=184525&status=done&width=972)![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565423291381-21e5ec47-0c31-4a19-a265-8aec06bb6bac.png#align=left&display=inline&height=322&name=image.png&originHeight=644&originWidth=1960&size=146601&status=done&width=980)

<a name="IrAxS"></a>
## 2.3 覆盖率

![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565423433492-214eef1c-5283-454b-9075-5140f49ebd00.png#align=left&display=inline&height=539&name=image.png&originHeight=1078&originWidth=1972&size=240533&status=done&width=986)![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565423443142-be0e8f60-ecdd-49c2-b994-226c9a0ce1fb.png#align=left&display=inline&height=269&name=image.png&originHeight=341&originWidth=944&size=157989&status=done&width=746)

<a name="sGvfB"></a>
## 2.4 多样性
![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565423494952-56b6d9f3-ddfb-40e6-abe9-5d0c8b26db68.png#align=left&display=inline&height=361&name=image.png&originHeight=722&originWidth=1970&size=206675&status=done&width=985)

<a name="2cxzs"></a>
## 2.5 新颖性

新颖的推荐是指给用户推荐那些他们以前没有听说过的物品。<br />一个简单办法就是**把那些用户之前在网站中对其有过行为的物品从推荐列表中过滤掉。**<br />**对于它的评测可以用推荐结果的平均流行度，因为越不热门的物品越可能让用户觉得新颖。**因此，**如果推荐结果中物品的平均热门程度较低，那么推荐结果就可能有比较高的新颖性。**

<a name="VHzWh"></a>
## 2.6 惊喜度

**注意与新颖度的区别。**<br />**如果推荐结果和用户的历史兴趣不相似，但却让用户觉得满意，那么就可以说推荐结果的惊喜度很高，而推荐的新颖性仅仅取决于用户是否听说过这个推荐结果。**

<a name="vT1Rb"></a>
## 2.7 信任度

对于基于机器学习的自动推荐系统，存在信任度（trust）的问题，**如果用户信任推荐系统，那就会增加用户和推荐系统的交互。**

度量推荐系统的信任度**只能通过问卷调查的方式，询问用户是否信任推荐系统的推荐结果。**

提高推荐系统的信任度主要有两种方法。**首先需要增加推荐系统的透明度（transparency），如提供推荐解释等；其次是考虑用户的社交网络信息，利用用户的好友信息给用户做推荐，并且用好友进行推荐解释。**

<a name="gFMga"></a>
## 2.8 实时性

**在很多网站中，因为物品（新闻、微博等）具有很强的时效性，所以需要在物品还具有时效性时就将它们推荐给用户。**实时性包括两个方面。**首先，推荐系统需要实时地更新推荐列表来满足用户新的行为变化；其次是推荐系统需要能够将新加入系统的物品推荐给用户。**

<a name="Q9KQk"></a>
## 2.9 健壮性

任何一个能带来利益的算法系统都会被人攻击，而**健壮性（即robust，鲁棒性）指标衡量了一个推荐系统抗击作弊的能力。**

算法健壮性的评测主要利用模拟攻击。**首先，给定一个数据集和一个算法，可以用这个算法给这个数据集中的用户生成推荐列表。然后，用常用的攻击方法向数据集中注入噪声数据，然后利用算法在注入噪声后的数据集上再次给用户生成推荐列表。最后，通过比较攻击前后推荐列表的相似度评测算法的健壮性。如果攻击后的推荐列表相对于攻击前没有发生大的变化，就说明算法比较健壮。**

提升健壮性的方法有：

- **设计推荐系统时尽量使用代价比较高的用户行为。**
- **在使用数据前，进行攻击检测，从而对数据进行清理。**

<a name="ER8AW"></a>
## 2.10 商业目标

**很多时候，网站评测推荐系统更加注重网站的商业目标是否达成，而商业目标和网站的盈利模式是息息相关的。**一般来说，**最本质的商业目标就是平均一个用户给公司带来的盈利。不过这种指标不是很难计算，只是计算一次需要比较大的代价。因此，很多公司会根据自己的盈利模式设计不同的商业目标。**

不同的网站具有不同的商业目标。比如电子商务网站的目标可能是销售额，基于展示广告盈利的网站其商业目标可能是广告展示总数，基于点击广告盈利的网站其商业目标可能是广告点击总数。因此，设计推荐系统时需要考虑最终的商业目标，而网站使用推荐系统的目的除了满足用户发现内容的需求，也需要利用推荐系统加快实现商业上的指标。

<a name="69JGB"></a>
## 2.11 总结

前面提到了很多指标，其中有些指标可以离线计算，有些只能在线获得。但是，离线指标很多，在线指标也很多，那么如何优化离线指标来提高在线指标是推荐系统研究的重要问题。下面是对于这些指标的总结：

![image.png](https://cdn.nlark.com/yuque/0/2019/png/200056/1565423832288-efff2ffa-f071-4ad4-a4a3-e4690a12a715.png#align=left&display=inline&height=457&name=image.png&originHeight=914&originWidth=1534&size=207861&status=done&width=767)

<a name="78xZS"></a>
# 3 评测维度

在评测系统中还需要考虑评测维度，比如**一个推荐算法，虽然整体性能不好，但可能在某种情况下性能比较好，而增加评测维度的目的就是知道一个算法在什么情况下性能最好。这样可以为融合不同推荐算法取得最好的整体性能带来参考。**

一般来说，评测维度分为如下3种。

- 用户维度 主要包括用户的人口统计学信息、活跃度以及是不是新用户等。
- 物品维度 包括物品的属性信息、流行度、平均分以及是不是新加入的物品等。
- 时间维度 包括季节，是工作日还是周末，是白天还是晚上等。

如果能够在**推荐系统评测报告中包含不同维度下的系统评测指标，就能全面地了解推荐系统性能，找到一个看上去比较弱的算法的优势，发现一个看上去比较强的算法的缺点。**